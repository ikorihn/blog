{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/2021/10/start-blog-with-gatsby/",
    "result": {"data":{"site":{"siteMetadata":{"title":"ikorihn Blog"}},"markdownRemark":{"id":"c4f64ed1-bd6a-51af-b1e3-d6850a78caa1","excerpt":"Gatsby.js について https://www.gatsbyjs.com/ Reactでつくられた静的サイトジェネレータ Reactをビルド時に1回だけ実行し、HTML,JSを生成する。\n生成されたファイルをホスティングサービスにデプロイするだけで見られるようになる。 GraphQL Gatsby.js…","html":"<h2 id=\"gatsbyjs-について\">Gatsby.js について</h2>\n<p><a href=\"https://www.gatsbyjs.com/\">https://www.gatsbyjs.com/</a></p>\n<p>Reactでつくられた静的サイトジェネレータ</p>\n<p>Reactをビルド時に1回だけ実行し、HTML,JSを生成する。\n生成されたファイルをホスティングサービスにデプロイするだけで見られるようになる。</p>\n<h3 id=\"graphql\">GraphQL</h3>\n<ul>\n<li>Gatsby.jsではビルド時のさまざまなデータをGraphQLで取得する。</li>\n<li>Markdown形式で書いた情報を、ファイルシステムから読み込んで、GraphQL経由で取得し、Reactコンポーネント内で表示する。</li>\n<li>GatsbyではMarkdownファイルに限らず、様々なデータを <code class=\"language-text\">data source</code>, <code class=\"language-text\">data transformer</code> という枠組みで一般化することで、多様な処理を統一的にかつ簡潔に記述することができている。</li>\n<li>クライアントはビルド時に形成されたGraphQL DBの全体は必要ないので、「クエリの結果」のみをJSONとして合わせてデプロイする。</li>\n</ul>\n<h2 id=\"starterを使ってblogを作成\">starterを使ってblogを作成</h2>\n<p>テンプレートを利用してブログを構築しました。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npx gatsby new gatsby-starter https://github.com/gatsbyjs/gatsby-starter-blog</code></pre></div>\n<p>※最初、<a href=\"https://www.gatsbyjs.com/starters/renyuanz/leonids/\">Leonids</a> で構築しましたがいまいち気に入らなかったので、<a href=\"https://www.gatsbyjs.com/starters/gatsbyjs/gatsby-starter-blog\">gatsby-starter-blog</a> で作り直しました。\n作り直すにあたっては、別ディレクトリでstarterから作成 → ファイル一式をコピー → TypeScriptへの変換等で地道に行いました。</p>\n<h2 id=\"typescript化する\">TypeScript化する</h2>\n<p>tsxに変更\nGraphQLのクエリ結果を型解決する</p>\n<h2 id=\"tailwindcss\">TailwindCSS</h2>\n<p>TailwindCSSのユーティリティを組み合わせる思想が好きでよく使用するので、本ブログでも\n<a href=\"https://www.gatsbyjs.com/docs/how-to/styling/tailwind-css/\">https://www.gatsbyjs.com/docs/how-to/styling/tailwind-css/</a>\nに沿って設定していきます。</p>\n<h3 id=\"インストール初期設定\">インストール、初期設定</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D tailwindcss@npm:@tailwindcss/postcss7-compat autoprefixer\nnpx tailwindcss init</code></pre></div>\n<h3 id=\"postcssで適用する\">PostCSSで適用する</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> postcss gatsby-plugin-postcss</code></pre></div>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-postcss</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<div class=\"gatsby-code-title\">postcss.config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tailwindcss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"base-cssを追加する\">base CSSを追加する</h3>\n<p><code class=\"language-text\">@tailwind</code> ディレクティブを使用してTailwindの <code class=\"language-text\">base</code>, <code class=\"language-text\">components</code>, <code class=\"language-text\">utilities</code> をCSSに挿入します。</p>\n<div class=\"gatsby-code-title\">src/index.css</div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> base<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> components<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> utilities<span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>カスタムCSSにTailwindのクラスを適用したい場合以下のように書ける</p>\n<div class=\"gatsby-code-title\">src/index.css</div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> base<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> components<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> utilities<span class=\"token punctuation\">;</span></span>\n\n<span class=\"token atrule\"><span class=\"token rule\">@import</span> popup.css body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@apply</span> bg-purple-200<span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">gatsby-browser.js</code> で読み込む</p>\n<div class=\"gatsby-code-title\">gatsby-browser.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"./src/index.css\"</span></code></pre></div>\n<h3 id=\"purge-を設定する\">Purge を設定する</h3>\n<p>デフォルトではTailwindCSS全体がビルドに含まれるため、ファイルサイズ削減のために必要なclassのみにpurgeする。</p>\n<div class=\"gatsby-code-title\">tailwind.config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  purge<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"./src/**/*.{js,jsx,ts,tsx}\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  theme<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  variants<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"tocを追加\">TOCを追加</h2>\n<p><a href=\"https://www.gatsbyjs.com/plugins/gatsby-remark-autolink-headers/\">gatsby-remark-autolink-headers</a> で見出しにアンカーがつくようにする</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> gatsby-remark-autolink-headers</code></pre></div>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-remark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-remark-autolink-headers</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n            options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              offsetY<span class=\"token operator\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n              icon<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n              maintainCase<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"tocコンポーネントを作成してページのコンポーネントに追加\">TOCコンポーネントを作成してページのコンポーネントに追加</h3>\n<div class=\"gatsby-highlight\" data-language=\"typescript:toc.tsx\"><pre class=\"language-typescript:toc.tsx\"><code class=\"language-typescript:toc.tsx\">import * as React from &#39;react&#39;\n\ntype Props = {\n  tocHtml?: string\n}\nconst Toc: React.FC&lt;Props&gt; = ({tocHtml}) =&gt; {\n  if (tocHtml === undefined) {\n    return &lt;&gt;&lt;/&gt;\n  }\n  return (\n    &lt;div className=&quot;toc bg-code-block px-4 py-1 my-2&quot;&gt;\n      &lt;h4 className=&quot;toc__title mt-2&quot;&gt;目次&lt;/h4&gt;\n      &lt;div\n        className=&quot;toc__content&quot;\n        dangerouslySetInnerHTML={{\n          __html: tocHtml,\n        }}\n      /&gt;\n    &lt;/div&gt;\n  )\n}\n\nexport default Toc</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"typescript:bolg-post.tsx\"><pre class=\"language-typescript:bolg-post.tsx\"><code class=\"language-typescript:bolg-post.tsx\">// ....\n  return (\n    &lt;Layout location={location} title={siteTitle}&gt;\n\n      &lt;article\n        className=&quot;blog-post&quot;\n        itemScope\n        itemType=&quot;http://schema.org/Article&quot;\n      &gt;\n        &lt;header&gt;\n          &lt;h1 itemProp=&quot;headline&quot;&gt;{post.frontmatter.title}&lt;/h1&gt;\n          &lt;p&gt;{post.frontmatter.date}&lt;/p&gt;\n        &lt;/header&gt;\n        &lt;section\n          className=&quot;blog-post__description&quot;\n        &gt;\n          {post.frontmatter.description}\n        &lt;/section&gt;\n        &lt;Toc\n          tocHtml={post.tableOfContents}\n        /&gt;\n// ...\n    &lt;/Layout&gt;\n  )</code></pre></div>\n<h2 id=\"コードブロックにタイトルを設定\">コードブロックにタイトルを設定</h2>\n<p>参考: <a href=\"https://littlebylittle.work/2020/01/gatsby-syntax-highlighting/\">Gatsbyにシンタックスハイライトを入れてコードをきれいに表示する | littlebylittle</a></p>\n<p><a href=\"https://www.gatsbyjs.com/plugins/gatsby-remark-code-titles/\">gatsby-remark-code-titles</a> を使って、コードブロックにタイトルをつけます</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> gatsby-remark-code-titles</code></pre></div>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-remark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">'gatsby-remark-code-titles'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-remark-prismjs</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>コードタイトル用のスタイルを追加</p>\n<div class=\"gatsby-code-title\">index.css</div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.gatsby-code-title</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@apply</span> bg-code-block text-text-light<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> -0.6rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 6px 12px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 0.8em<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> bold<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> table<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 4px 4px 0 0<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#gatsbyjs-%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\">Gatsby.js について</a></p>\n<ul>\n<li><a href=\"#graphql\">GraphQL</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#starter%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6blog%E3%82%92%E4%BD%9C%E6%88%90\">starterを使ってblogを作成</a></p>\n</li>\n<li>\n<p><a href=\"#typescript%E5%8C%96%E3%81%99%E3%82%8B\">TypeScript化する</a></p>\n</li>\n<li>\n<p><a href=\"#tailwindcss\">TailwindCSS</a></p>\n<ul>\n<li><a href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A\">インストール、初期設定</a></li>\n<li><a href=\"#postcss%E3%81%A7%E9%81%A9%E7%94%A8%E3%81%99%E3%82%8B\">PostCSSで適用する</a></li>\n<li><a href=\"#base-css%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\">base CSSを追加する</a></li>\n<li><a href=\"#purge-%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\">Purge を設定する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#toc%E3%82%92%E8%BF%BD%E5%8A%A0\">TOCを追加</a></p>\n<ul>\n<li><a href=\"#toc%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E3%81%A6%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AB%E8%BF%BD%E5%8A%A0\">TOCコンポーネントを作成してページのコンポーネントに追加</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%81%AB%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%82%92%E8%A8%AD%E5%AE%9A\">コードブロックにタイトルを設定</a></p>\n</li>\n</ul>","frontmatter":{"title":"Gatsbyでブログを作ったので、構築ログを残す","date":"October 10, 2021","description":"このブログはGatsby + Netlify で作成しています。備忘録も兼ねて、構築ログを残しておきます。"}},"previous":{"fields":{"slug":"/2021/09/jenkins-ui-customize/"},"frontmatter":{"title":"Jenkinsの見た目をカスタマイズ"}},"next":{"fields":{"slug":"/2021/10/build-typescript-on-netlify/"},"frontmatter":{"title":"TypeScriptのGatsbyをNetlifyでビルドしたときのエラーに対応した"}}},"pageContext":{"id":"c4f64ed1-bd6a-51af-b1e3-d6850a78caa1","previousPostId":"e784d22a-e16b-5507-9f22-9701a95311bc","nextPostId":"257f86e4-c102-5bd2-b09a-a5b7f0c5aecf"}},
    "staticQueryHashes": ["1857159792","984448874"]}